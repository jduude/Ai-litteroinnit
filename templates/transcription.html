<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>{{ transcription.title }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">


</head>

<body>
    <div class="main-wrapper">
        <div class="header">
            {% include 'navigation.html' %}
        </div>

        <h2>Litterointi {{ transcription.id }}</h2>
        <h2>{{ transcription.title }}</h2>

        {% for message in get_flashed_messages() %}
        <p class="flash-message">
            <b>{{ message }}</b>
        </p>
        {% endfor %}

        <ul>

            <li>Id: {{ transcription.id }}</li>
            <li>Tiedosto tai url: <a href="{{ transcription.source_path }}">{{ transcription.source_path }}</a></li>
            <li>Lähde: {{ transcription.source }}</li>
            <li>Lajityyppi: {{ transcription.genre }}</li>
            <li>Tallenteen päivämäärä: {{ transcription.record_date }}</li>
            <li>Pituus: {{ convert_seconds_to_hms(transcription.duration_sec) }}</li>
            <li>Lisenssi: {{ transcription.license }}</li>
            <li>Metadata: {{ transcription.extra_meta_data }}</li>
            <li>Luotu: {{ transcription.created }}</li>
            <li>Muokattu: {{ transcription.last_modified }}</li>
            <li>Raaka sisältö:
                {% if transcription.raw_content %}
                {{ transcription.raw_content[:50] }} ...
                {% else %}
                <span>TYHJÄ</span>
                {% endif %}
            </li>
            <li>Käyttäjä: {{ user.username }}</li>

            <li>Salli muiden käyttäjien muokata: {{ "Kyllä" if transcription.allow_collaboration else "Ei" }}</li>
        </ul>
        {% if transcription.allow_collaboration or transcription.user_id == session.user_id%}
        <p><a href="/edit/{{ transcription.id }}">Muokkaa</a> </p>
        <hr>
        {% endif %}

        {% if local_audio_file_copy_exists %}

        <div id="audio-player">
            <audio controls autoplay>
                <source src="{{url_for('static', filename=audio_file_path)}}#t={{audiotime}}" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
        </div>
        {% endif %}


        <div>
            {% if text_fragments %}
            <h3>Aikakoodi tekstit sivu {{page}}:</h3>

            <p>
                <a href="/transcription/{{ transcription.id }}/{{ page - 10 }}">&lt;&lt;&lt;</a>
                <a href="/transcription/{{ transcription.id }}/{{ page - 1 }}">&lt;&lt;</a>
                Sivu {{ page }} / {{ page_count }}
                <a
                    href="/transcription/{{ transcription.id }}/{{ page + 1 }}?audiotime={{next_page_time_str}}#audio-player">&gt;&gt;</a>
                <a href="/transcription/{{ transcription.id }}/{{ page + 10 }}">&gt;&gt;&gt;</a>
            </p>


        </div>

        <div class="text-fragments">

            {% include 'transcriptions_texts_listing.html' %}

        </div>

        <p>
            <a href="/transcription/{{ transcription.id }}/{{ page - 10 }}">&lt;&lt;&lt;</a>
            <a href="/transcription/{{ transcription.id }}/{{ page - 1 }}">&lt;&lt;</a>
            Sivu {{ page }} / {{ page_count }}<a
                href="/transcription/{{ transcription.id }}/{{ page + 1 }}?audiotime={{next_page_time_str}}#audio-player">
                &gt;&gt;</a>
            <a href="/transcription/{{ transcription.id }}/{{ page + 10 }}">&gt;&gt;&gt;</a>
        </p>

        {% else %}
        <div class="create-timed-texts">
            <a href="/text_fragments/{{ transcription.id }}">Luo teksti fragmentit</a>
        </div>

        {% endif %}

        {% if transcription.allow_collaboration or transcription.user_id == session.user_id %}
        <div>

            <a href="/edit/{{ transcription.id }}">Muokkaa litterointia</a>
            {% if transcription.user_id == session.user_id %}
            | <a href="/remove/{{ transcription.id }}">Poista koko litterointi</a>
            {% endif %}
            <br>
            <br>
            <a href="/remove_transcription_split_text/{{ transcription.id }}">Poista vain aikakoodi rivitetyt
                tekstit</a>


            {% endif %}
            <hr />

        </div>

        <p>
            <a href="/">Etusivulle</a>
        </p>
    </div>
</body>

</html>